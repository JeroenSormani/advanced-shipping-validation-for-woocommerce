"use strict";jQuery(function(a){function c(){a(".wpc-condition-group").repeater({addTrigger:".wpc-condition-add",removeTrigger:".wpc-condition-delete",template:".wpc-condition-template .wpc-condition-wrap",elementWrap:".wpc-condition-wrap",elementsContainer:".wpc-conditions-list"})}a(".wpc-conditions").repeater({addTrigger:".wpc-condition-group-add",removeTrigger:".wpc-condition-group .delete",template:".wpc-condition-group-template .wpc-condition-group-wrap",elementWrap:".wpc-condition-group-wrap",elementsContainer:".wpc-condition-groups",removeElement:function(t){t.remove()}}),c(),jQuery(document.body).on("repeater-added-row",function(t,o,e,n){var i=Math.floor(899999999*Math.random()+1e8);o.find("input[name], select[name]").attr("name",function(t,o){return o.replace("9999",i)||o}),o.find(".wpc-condition[data-id]").attr("data-id",function(t,o){return o.replace("9999",i)||o}),o.find(".wpc-condition-template .wpc-condition[data-id]").attr("data-id","9999"),o.find("[data-group]").attr("data-group",function(t,o){return o.replace("9999",i)||o}),o.find(".repeater-active").removeClass("repeater-active"),c()}),a(document.body).on("click",".wpc-conditions .duplicate",function(){var t=a(this).parents(".wpc-condition-group-wrap"),e=t.find(".wpc-condition-group").attr("data-group"),o=a(this).parents(".wpc-condition-groups"),n=Math.floor(899999999*Math.random()+1e8);t.find(".enhanced").select2("destroy").removeClass("enhanced");var i=t.clone();a(t).find("select").each(function(t){a(i).find("select").eq(t).val(a(this).val())}),i.find(".wpc-condition-group").attr("data-group",n),i.find("input[name], select[name]").attr("name",function(t,o){return o.replace("conditions["+e+"]","conditions["+n+"]")}),i.find(".repeater-active").removeClass("repeater-active"),o.append(i),a(document.body).trigger("wc-enhanced-select-init"),c(),a("html, body").on("scroll mousedown DOMMouseScroll mousewheel keydown touchmove",function(t){a("html, body").stop().off("scroll mousedown DOMMouseScroll mousewheel keydown touchmove")}),a("body, html").animate({scrollTop:a(i).offset().top-50},750,function(){a("html, body").off("scroll mousedown DOMMouseScroll mousewheel keydown touchmove")})}),a(document.body).on("change",".wpc-condition",function(){var o={action:wpc2.action_prefix+"update_condition_value",id:a(this).attr("data-id"),group:a(this).parents(".wpc-condition-group").attr("data-group"),condition:a(this).val(),nonce:wpc.nonce},e=a(this).parents(".wpc-condition-wrap").first(),n=".wpc-value-field-wrap";e.find(n).html('<span style="width: calc( 42.5% - 75px ); border: 1px solid transparent; display: inline-block;">&nbsp;</span>').block({message:null,overlayCSS:{background:"",opacity:.6}}),a.post(ajaxurl,o,function(t){e.find(n).replaceWith(t),a(document.body).trigger("wc-enhanced-select-init")});var i=e.find(".wpc-operator").val();e.find(".wpc-operator").empty().html(function(){var e=a(this),t=wpc.condition_operators[o.condition]||wpc.condition_operators.default;a.each(t,function(t,o){e.append(a("<option/>").attr("value",t).text(o)),e.val(i).val()||e.val(e.find("option:first").val())})}),e.find(".wpc-description").html(function(){return a('<span class="woocommerce-help-tip" />').attr("data-tip",wpc.condition_descriptions[o.condition]||"")}),a(".tips, .help_tip, .woocommerce-help-tip").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200}),a("#tiptip_holder").removeAttr("style"),a("#tiptip_arrow").removeAttr("style")}),a(".wpc-conditions-post-table.wpc-sortable-post-table tbody").sortable({items:"tr",handle:".sort",cursor:"move",axis:"y",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.65,placeholder:"wc-metabox-sortable-placeholder",start:function(t,o){o.item.css("background-color","#f6f6f6")},stop:function(t,o){o.item.removeAttr("style")},update:function(t,o){$table=a(this).closest("table"),$table.block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var e={action:"wpc_save_post_order",form:a(this).closest("form").serialize(),nonce:wpc.nonce};a.post(ajaxurl,e,function(t){a(".wpc-conditions-post-table tbody tr:even").addClass("alternate"),a(".wpc-conditions-post-table tbody tr:odd").removeClass("alternate"),$table.unblock()})}})});